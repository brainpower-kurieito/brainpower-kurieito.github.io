/*! For license information please see app.js.LICENSE.txt */
!function(){"use strict";var t,e={598:function(t,e,i){var s=i(260),o=i.n(s),n=i(79);function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class r extends o().GameObjects.Container{constructor(t,e,i,s,o,n){super(t,e,i),a(this,"text",void 0),a(this,"rect",void 0),a(this,"hoverColor",void 0),a(this,"restColor",void 0),a(this,"activeColor",void 0);const{fontColor:r,fontSize:h,width:c=140,height:d=30,hoverColor:l,restColor:u,activeColor:m,strokeColor:g}=o;this.setSize(c,d),this.hoverColor=l,this.restColor=u,this.activeColor=m,this.text=t.add.text(0,-d/4,s,{fill:r,fontSize:h}),this.text.setX(-this.text.displayWidth/2),this.rect=t.add.rectangle(0,0,c,d,u),this.rect.setStrokeStyle(1,g).setOrigin(.5,.5),this.add([this.rect,this.text]),this.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.enterButtonActiveState())).on("pointerover",(()=>this.enterButtonHoverState())).on("pointerout",(()=>this.enterButtonRestState())).on("pointerup",(()=>{this.enterButtonHoverState(),n()}))}enterButtonHoverState(){this.rect.fillColor=this.hoverColor}enterButtonRestState(){this.rect.fillColor=this.restColor}enterButtonActiveState(){this.rect.fillColor=this.activeColor}}const h={fontColor:"#fff",fontSize:"16px",width:140,height:30,hoverColor:6341059,restColor:3906204,activeColor:2979191,strokeColor:16777215},c={fontColor:"#fff",fontSize:"16px",width:140,height:30,hoverColor:13026245,restColor:10722974,activeColor:7301997,strokeColor:16777215},d={fontColor:"#fff",fontSize:"16px",width:140,height:30,hoverColor:14596684,restColor:13674279,activeColor:12293667,strokeColor:16777215};function l(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,m(t,e,"get"))}function u(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,m(t,e,"set"),i),i}function m(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var g=new WeakMap,p=new WeakMap,f=new WeakMap,w=new WeakMap;class v{constructor(t){g.set(this,{writable:!0,value:void 0}),p.set(this,{writable:!0,value:void 0}),f.set(this,{writable:!0,value:0}),w.set(this,{writable:!0,value:!0}),u(this,g,t)}setButtons(t){u(this,p,t);const e=l(this,g).addKey("W"),i=l(this,g).addKey("S"),s=l(this,g).addKey("SPACE");e.on("down",this.cursorUp.bind(this)),i.on("down",this.cursorDown.bind(this)),s.on("down",this.buttonKeyDown.bind(this)),s.on("up",this.buttonKeyUp.bind(this)),l(this,p)[l(this,f)].emit("pointerover")}cursorUp(){l(this,w)&&(l(this,p)[l(this,f)].emit("pointerout"),u(this,f,l(this,f)+(l(this,p).length-1)),u(this,f,l(this,f)%l(this,p).length),l(this,p)[l(this,f)].emit("pointerover"))}cursorDown(){l(this,w)&&(l(this,p)[l(this,f)].emit("pointerout"),u(this,f,+l(this,f)+1),u(this,f,l(this,f)%l(this,p).length),l(this,p)[l(this,f)].emit("pointerover"))}buttonKeyDown(){l(this,w)&&l(this,p)[l(this,f)].emit("pointerdown")}buttonKeyUp(){l(this,w)&&l(this,p)[l(this,f)].emit("pointerup")}activate(){u(this,w,!0)}deactivate(){u(this,w,!1)}}function x(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,y(t,e,"get"))}function b(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,y(t,e,"set"),i),i}function y(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var S=new WeakMap,_=class extends o().Scene{constructor(){super({key:"TitleScene"}),S.set(this,{writable:!0,value:void 0})}preload(){this.load.image("title","assets/images/title.png")}create(){b(this,S,this.data.has("volume")?this.data.get("volume"):1),this.data.set("volume",x(this,S));const t=this.game.config.width,e=this.game.config.height,i=this.add.image(t/2,e/2,"title");i.setScale(t/i.width,e/i.height);const s=new v(this.input.keyboard),o={...d,fontSize:"20px",width:200,height:40},n=new r(this,t/2,e/2+55,"START",o,(()=>this.scene.start("DoraScene",{volume:x(this,S)})));this.add.existing(n);const a=new r(this,t/2,e/2+110,"操作説明",h,(()=>this.openKeyModal(t,e,s)));this.add.existing(a);const l=new r(this,t/2,e/2+160,"ストーリー",h,(()=>this.openStoryModal(t,e,s)));this.add.existing(l);const u=new r(this,t/2,e/2+210,"クレジット",h,(()=>this.openCreditModal(t,e,s)));this.add.existing(u),this.volumeText=this.add.text(t-60,e-30,(10*x(this,S)).toFixed(0),{fontSize:"20px",fill:"#000",align:"center"}),this.add.existing(this.volumeText);const m={...c,width:30},g=new r(this,t-20,e-20,"+",m,(()=>this.updateVolume(.1)));this.add.existing(g);const p=new r(this,t-80,e-20,"-",m,(()=>this.updateVolume(-.1)));this.add.existing(p),s.setButtons([n,a,l,u,p,g])}openKeyModal(t,e,i){i.deactivate();const s=this.add.container(t/2,e/2),o=this.add.rectangle(0,0,t/1.2,e/1.2,16777215);s.add(o),new v(this.input.keyboard).setButtons([o]);const a=this.add.text(0,0,"Lorem ipsum 1",{color:"#000"});s.add(a);const r=new n.im(s,{duration:{in:100,out:100}});o.setInteractive().on("pointerup",(()=>{r.requestClose(),i.activate()}))}openStoryModal(t,e,i){i.deactivate();const s=this.add.container(t/2,e/2),o=this.add.rectangle(0,0,t/1.2,e/1.2,16777215);s.add(o),new v(this.input.keyboard).setButtons([o]);const a=this.add.text(0,0,"Lorem ipsum 2",{color:"#000"});s.add(a);const r=new n.im(s,{duration:{in:100,out:100}});o.setInteractive().on("pointerup",(()=>{r.requestClose(),i.activate()}))}openCreditModal(t,e,i){i.deactivate();const s=this.add.container(t/2,e/2),o=this.add.rectangle(0,0,t/1.2,e/1.2,16777215);s.add(o),new v(this.input.keyboard).setButtons([o]);const a=this.add.text(0,0,"Lorem ipsum 3",{color:"#000"});s.add(a);const r=new n.im(s,{duration:{in:100,out:100}});o.setInteractive().on("pointerup",(()=>{r.requestClose(),i.activate()}))}updateVolume(t){const e=x(this,S)+t;0>e||1<e||(b(this,S,e),this.data.set("volume",e),this.volumeText.text=(10*e).toFixed(0))}},C=class extends o().Scene{constructor(){super({key:"ResultScene"})}create(t){const e=this.game.config.width,i=this.game.config.height,s="score"in t?t.score:0;this.add.text(e/2,i/5,"score: "+s,{fill:"#fff"}),this.add.text(e/2,i/4,"いかがでしたか？",{fill:"#fff"}).setFontSize(32);const o=new r(this,e/2,i/1.8,"ツイートで共有",h,(()=>this.tweetScore(s)));this.add.existing(o);const n=new r(this,e/2,i/1.5,"BACK TO TITLE",h,(()=>this.scene.start("TitleScene")));this.add.existing(n),new v(this.input.keyboard).setButtons([o,n])}tweetScore(t){let e="https://twitter.com/intent/tweet";e+="?"+new URLSearchParams({text:`銅鑼のパワーでクエを気絶させました！ スコア：${t}`,hashtags:"dorakue",url:"https://brainpower-kurieito.github.io/"}),window.open(e,"_blank")}};function T(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,M(t,e,"get"))}function k(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,M(t,e,"set"),i),i}function M(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var I=new WeakMap,D=new WeakMap,O=new WeakMap;class E extends o().GameObjects.Sprite{constructor(t,e,i,s,o){super(t,e,i,"kue",o),I.set(this,{writable:!0,value:-4}),D.set(this,{writable:!0,value:0}),O.set(this,{writable:!0,value:void 0}),this.setScale(.1),k(this,O,s??!1)}faint(){this.destroy()}update(){super.update(),k(this,D,T(this,D)+Math.PI/30),this.x+=T(this,I),(0>this.x||800<this.x)&&(k(this,I,-1*T(this,I)),this.flipX=!this.flipX),T(this,O)&&(this.y+=Math.round(5*Math.sin(T(this,D))))}}function W(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,B(t,e,"get"))}function B(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var K=new WeakMap,F=new WeakSet;class z{constructor(t){F.add(this),function(t,e,i){e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"group",void 0),K.set(this,{writable:!0,value:void 0}),this.group=new(o().GameObjects.Group),t.add.existing(this.group),function(t,e,i){(function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}})(t,B(t,e,"set"),i)}(this,K,t)}spawn(t,e,i){if(!(this.group.getLength()>=5)){if(!t||!e){const[s,o,n]=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}(this,F,R).call(this);t??(t=s),e??(e=o),i??(i=n)}const s=new E(W(this,K),t,e,i);W(this,K).add.existing(s),this.group.add(s)}}faint(t,e,i){let s=0;const o=[];for(const n of this.group.getChildren())(n.x-t)**2+(n.y-e)**2<i**2&&(o.push(n),s++);return o.map((t=>t.faint())),s}}function R(){return[Math.floor(800*Math.random()),Math.floor(600*Math.random()),.5<=Math.random()]}class U extends o().GameObjects.Sprite{constructor(t,e,i,s,o,n,a,r,h,c,d){super(t,e,i,"logo"),this.keys=s,this.setScale(o),this.pScale=o,this.x=e,this.y=i,this.collisionX=n-this.width*o/2,this.collisionY=a-this.height*o/2,this.doraSound=r,this.coolTime=1e3*h,this.speed=c,this.range=d,this.isRinging=!1,this.scene=t,this.circle=this.scene.add.circle(e,i,d),this.circle.setStrokeStyle(2,1729964)}ring(){this.isRinging=!0}ringComplete(){this.isRinging=!1}move(){this.isRinging||(this.keys.W.isDown&&(this.y-=this.speed),this.keys.S.isDown&&(this.y+=this.speed),this.keys.A.isDown&&(this.x-=this.speed),this.keys.D.isDown&&(this.x+=this.speed),this.y=Math.max(this.height*this.pScale/2,Math.min(this.y,this.collisionY)),this.x=Math.max(this.width*this.pScale/2,Math.min(this.x,this.collisionX)),this.circle.x=this.x,this.circle.y=this.y)}hitDora(){return this.isRinging?null:(this.ring(),this.doraSound.play(),this.scene.time.delayedCall(this.coolTime,this.ringComplete,[],this),[this.x,this.y,this.range])}}function j(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function P(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,X(t,e,"get"))}function V(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,X(t,e,"set"),i),i}function X(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Y=new WeakMap,A=new WeakMap,G=new WeakMap,L=new WeakMap,H=class extends o().Scene{constructor(){super({key:"DoraScene"}),j(this,"keys",void 0),j(this,"logo",void 0),Y.set(this,{writable:!0,value:void 0}),A.set(this,{writable:!0,value:0}),G.set(this,{writable:!0,value:void 0}),L.set(this,{writable:!0,value:0})}preload(){this.load.image("sky","http://labs.phaser.io/assets/skies/space3.png"),this.load.image("red","http://labs.phaser.io/assets/particles/red.png"),this.load.image("logo","assets/images/china_dora_tamtam_ipo.png"),this.load.image("kue","assets/images/fish_kue2.png"),this.load.image("three","assets/images/san.png"),this.load.image("two","assets/images/nii.png"),this.load.image("one","assets/images/ichi.png"),this.load.image("start","assets/images/start.png"),this.load.image("end","assets/images/end.png"),this.load.audio("theme","assets/audio/DORAKUEloop.ogg"),this.load.audio("doraSound","assets/audio/effects/dorakick_0.ogg")}create(t){this.backGround=this.add.image(400,300,"sky");const e="volume"in t?t.volume:0;this.sound.add("theme",{volume:.4*e}).play(),this.game.events.on(o().Core.Events.BLUR,(()=>{this.scene.pause()})),this.game.events.on(o().Core.Events.FOCUS,(()=>{this.scene.resume()})),this._score=0,this._add_score=0,this._timeCounter=0,this._leftTimeMS=6e4,this._leftTimeText=this.add.text(300,16,"Time: "+this._leftTimeMS/1e3,{fontSize:"28px",fill:"#FFF"}),this._scoreText=this.add.text(300,50,"Score: "+this._score,{fontSize:"28px",fill:"#FFF"}),this._addScoreText=this.add.text(300,200,this._add_score,{fontSize:"56px",fill:"#FFF"}),this.add_score_tween=this.tweens.add({targets:this._addScoreText,alpha:0,duration:2e3,ease:"Power2"}),this._addScoreText.setVisible(!1),this.keys=this.input.keyboard.addKeys("W,S,A,D"),this.spacebar=this.input.keyboard.addKey(o().Input.Keyboard.KeyCodes.SPACE);const i=this.game.config.width,s=this.game.config.height,n=this.sound.add("doraSound",{volume:.7*e});V(this,G,new U(this,i/2,s/2,this.keys,.1,i,s,n,.7,5,100)),this.add.existing(P(this,G)),V(this,Y,new z(this)),P(this,Y).spawn(100,100),P(this,Y).group.runChildUpdate=!0,V(this,L,0),this.countDownTime=0,this.countDownIndex=3,this.timeIsUpCount=0,this.countImages=[,,,,,],this.countImages[3]=this.add.image(400,300,"three"),this.countImages[3].setVisible(!0),this.countImages[2]=this.add.image(400,300,"two"),this.countImages[2].setVisible(!1),this.countImages[1]=this.add.image(400,300,"one"),this.countImages[1].setVisible(!1),this.countImages[0]=this.add.image(400,300,"start"),this.countImages[0].setVisible(!1),this.countImages[4]=this.add.image(400,300,"end"),this.countImages[4].setVisible(!1),this.setCamera(i,s),this.scoreTextX=0,this.scoreTextY=0,this._timeCounter_last_beat=0,this._combo=0}update(t,e){0===P(this,L)&&this.gameStart(e),1===P(this,L)&&this.gamePlaying(e),2===P(this,L)&&this.gameEnd(e)}setCamera(t,e){this.textCamera=this.cameras.add(0,0,t,e),this.minimap=this.cameras.add(10,10,0,0).setZoom(.2).setName("mini"),this.minimap.setBackgroundColor(8772),this.minimap.scrollX=0,this.minimap.scrollY=0,this.cameras.main.ignore(this._leftTimeText),this.cameras.main.ignore(this._scoreText),this.cameras.main.ignore(this._addScoreText),this.minimap.ignore(this._leftTimeText),this.minimap.ignore(this._scoreText),this.minimap.ignore(this._addScoreText),this.textCamera.ignore(this.backGround),this.textCamera.ignore(P(this,G)),this.textCamera.ignore(P(this,G).circle),this.textCamera.ignore(P(this,Y).group),this.countImages.forEach((t=>{this.minimap.ignore(t),this.cameras.main.ignore(t)})),this.cameras.main.setBounds(0,0,800,600),this.cameras.main.zoom=2,this.cameras.main.startFollow(P(this,G),!0)}gameStart(t){this.countDownTime+=t,this.countDownTime>=1e3&&(this.countImages[this.countDownIndex].destroy(),1<=this.countDownIndex?this.countImages[this.countDownIndex-1].setVisible(!0):V(this,L,1),this.countDownIndex--,this.countDownTime=0)}gamePlaying(t){P(this,G).move();const e=P(this,G),i=P(this,Y);if(o().Input.Keyboard.JustDown(this.spacebar)){const t=e.hitDora();if(null!=t){const[e,s,o]=t;this._faint_count=i.faint(e,s,o),this._add_score=this.handlingScore(this._faint_count),this._score+=this._add_score,0<this._add_score&&(this.scoreTextX=200>e?2*e:600<e?this.game.config.width/2+2*(e-600):this.game.config.width/2,this.scoreTextY=150>s?2*s:450<s?this.game.config.height/2+2*(s-450):this.game.config.height/2,this.scoreTextX-=28,this.scoreTextY-=28,this._addScoreText.setX(this.scoreTextX),this._addScoreText.setY(this.scoreTextY),this._addScoreText.setVisible(!0),this.add_score_tween.restart())}}V(this,A,P(this,A)+t),P(this,A)>=2e3&&(P(this,Y).spawn(),V(this,A,0),this.textCamera.ignore(P(this,Y).group)),this._timeCounter+=this.time.elapsed,this._leftTimeMS-=t,this._leftTimeText.text="Time: "+Math.max(0,Math.floor(this._leftTimeMS/1e3)),this._timeCounter_last_beat+=t,this.scoreTextY--,this._addScoreText.setY(this.scoreTextY),this._scoreText.text="Score: "+this._score,this._addScoreText.text=this._add_score,0>=this._leftTimeMS&&(this._timeCounter=0,V(this,L,2))}gameEnd(t){this.countImages[4].setVisible(!0),this.timeIsUpCount+=t,this.timeIsUpCount>=3e3&&(this.countImages[4].destroy(),this.scene.start("ResultScene",{score:this._score}))}getScoreCalc(t,e){return this._continuous_bonus=Math.floor(e/5),(2*this._continuous_bonus+t+1)*t/2}handlingScore(t){return(this._timeCounter_last_beat>5e3||0===t)&&(this._combo=0),this._combo+=t,this._timeCounter_last_beat=0,this.getScoreCalc(t,this._combo)}},q={type:o().AUTO,width:800,height:600};const J=Object.assign(q,{scene:[_,H,C]});class N extends o().Game{constructor(){super(J)}}window.game=new N}},i={};function s(t){var o=i[t];if(void 0!==o)return o.exports;var n=i[t]={exports:{}};return e[t].call(n.exports,n,n.exports,s),n.exports}s.m=e,t=[],s.O=function(e,i,o,n){if(!i){var a=1/0;for(c=0;c<t.length;c++){i=t[c][0],o=t[c][1],n=t[c][2];for(var r=!0,h=0;h<i.length;h++)(!1&n||a>=n)&&Object.keys(s.O).every((function(t){return s.O[t](i[h])}))?i.splice(h--,1):(r=!1,n<a&&(a=n));r&&(t.splice(c--,1),e=o())}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[i,o,n]},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var o,n,a=i[0],r=i[1],h=i[2],c=0;for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(h)var d=h(s);for(e&&e(i);c<a.length;c++)n=a[c],s.o(t,n)&&t[n]&&t[n][0](),t[a[c]]=0;return s.O(d)},i=self.webpackChunkdorakue=self.webpackChunkdorakue||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var o=s.O(void 0,[906],(function(){return s(598)}));o=s.O(o)}();